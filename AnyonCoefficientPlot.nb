(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8385,        254]
NotebookOptionsPosition[      7900,        239]
NotebookOutlinePosition[      8241,        254]
CellTagsIndexPosition[      8198,        251]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Phi]", "n_"], "[", "x_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"\[Pi]", "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "4"}], ")"}]}]}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"2", "^", "n"}], "*", 
       RowBox[{"Factorial", "[", "n", "]"}]}], "]"}]}], " ", "*", " ", 
    RowBox[{"HermiteH", "[", 
     RowBox[{"n", ",", "x"}], "]"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"x", "^", "2"}]}], "/", "2"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Psi]", "F"], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Phi]", "0"], "[", "x", "]"}], 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], "[", "y", "]"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Phi]", "0"], "[", "y", "]"}], 
       RowBox[{
        SubscriptBox["\[Phi]", "1"], "[", "x", "]"}]}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "F"], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], " ", "=", " ", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Psi]", "F"], "[", 
       RowBox[{"x", ",", 
        SubscriptBox["x", "2"]}], "]"}], "*", 
      RowBox[{
       SubscriptBox["\[Psi]", "F"], "[", 
       RowBox[{"y", ",", 
        SubscriptBox["x", "2"]}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "2"], ",", 
       RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "A"], "[", 
    RowBox[{"x_", ",", "y_", ",", "\[Kappa]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Rho]", "F"], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "-", 
    RowBox[{
     RowBox[{"Sign", "[", 
      RowBox[{"y", "-", "x"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sign", "[", 
            RowBox[{"y", "-", "x"}], "]"}]}], "*", "I", "*", "\[Pi]", "*", 
          "\[Kappa]"}], ")"}]}], "+", "1"}], ")"}], "*", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Psi]", "F"], "[", 
         RowBox[{"x", ",", 
          SubscriptBox["x", "2"]}], "]"}], "*", 
        RowBox[{
         SubscriptBox["\[Psi]", "F"], "[", 
         RowBox[{"y", ",", 
          SubscriptBox["x", "2"]}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "2"], ",", "x", ",", " ", "y"}], "}"}]}], 
      "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["n", "A"], "[", 
    RowBox[{"p_", ",", "\[Kappa]_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]"}], ")"}]}], "*", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"I", "*", "p", "*", 
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["\[Rho]", "A"], "[", 
        RowBox[{"x", ",", "y", ",", "\[Kappa]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<LocalAdaptive\>\"", ",", " ", 
         RowBox[{"Method", "\[Rule]", "\"\<CartesianRule\>\""}]}], "}"}]}], 
      ",", " ", 
      RowBox[{"AccuracyGoal", "\[Rule]", "13"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "13"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.737724268482638*^9, 3.7377242724224243`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"206fc001-5df5-40f6-bff3-70e4920a0fa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Evaluate", " ", "n", 
    RowBox[{"(", "p", ")"}], " ", "at", " ", "various", " ", "points", " ", 
    "to", " ", "extract", " ", "momentum", " ", "tail", " ", "coefficient"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"domain", " ", "=", "  ", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "27"}], ",", 
         RowBox[{"-", "22"}], ",", "1"}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"22", ",", "27", ",", "1"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["data", "\[Kappa]_"], ":=", 
     RowBox[{
      SubscriptBox["n", "A"], "[", 
      RowBox[{"domain", ",", " ", "\[Kappa]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["CList", "\[Kappa]_"], ":=", 
     RowBox[{
      RowBox[{"domain", "^", "4"}], " ", "*", " ", 
      SubscriptBox["data", "\[Kappa]"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7377230756736975`*^9, 3.737723076624717*^9}, {
  3.737724146006336*^9, 3.737724158567424*^9}, {3.7377243815456696`*^9, 
  3.7377243819122877`*^9}, {3.737724430649819*^9, 3.73772443477944*^9}, {
  3.7377245516364546`*^9, 3.7377245951700068`*^9}, {3.737724655151501*^9, 
  3.7377246661928353`*^9}, {3.737724723253127*^9, 3.7377247507258005`*^9}, {
  3.7377247957487335`*^9, 3.737724798280037*^9}, {3.7377248509641047`*^9, 
  3.73772492034037*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"d21a85d1-16bf-4794-a68b-5ddf55edc457"],

Cell[BoxData[{
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["data", 
     RowBox[{"i", "/", "5"}]], "=", 
    RowBox[{"Re", "[", 
     SubscriptBox["data", 
      RowBox[{"i", "/", "5"}]], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coeffs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Coeffs", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"Coeffs", ",", 
       RowBox[{"Mean", "[", 
        SubscriptBox["CList", 
         RowBox[{"i", "/", "5"}]], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Coeffs", "=", 
  RowBox[{"Coeffs", "/", 
   RowBox[{"Coeffs", "[", 
    RowBox[{"[", "1", "]"}], "]"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Divide", " ", "by", " ", "the", " ", "momentum", " ", "tail", " ", 
     "coefficient", " ", "for", " ", "hardcore", " ", "bosons", " ", 
     "because", " ", "we", " ", "wish", " ", "to", " ", "plot", " ", "the", 
     " ", "numerical", " ", "ratio"}], " ", "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.737724928693474*^9, 3.737725062099222*^9}, 
   3.7377251568896694`*^9},ExpressionUUID->"e366c1dd-dde5-4e33-9520-\
d58eae991766"]
},
WindowSize->{1584, 816},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4368, 136, 106, "Input",ExpressionUUID->"206fc001-5df5-40f6-bff3-70e4920a0fa0"],
Cell[4929, 158, 1610, 39, 88, "Input",ExpressionUUID->"d21a85d1-16bf-4794-a68b-5ddf55edc457"],
Cell[6542, 199, 1354, 38, 86, "Input",ExpressionUUID->"e366c1dd-dde5-4e33-9520-d58eae991766"]
}
]
*)

