(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9515,        296]
NotebookOptionsPosition[      8998,        279]
NotebookOutlinePosition[      9341,        294]
CellTagsIndexPosition[      9298,        291]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Phi]", "n_"], "[", "x_", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"\[Pi]", "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "4"}], ")"}]}]}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"2", "^", "n"}], "*", 
       RowBox[{"Factorial", "[", "n", "]"}]}], "]"}]}], " ", "*", " ", 
    RowBox[{"HermiteH", "[", 
     RowBox[{"n", ",", "x"}], "]"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"x", "^", "2"}]}], "/", "2"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "t_", "]"}], "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "+", 
     RowBox[{"t", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]", "[", "t_", "]"}], "=", 
   RowBox[{"ArcTan", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalPhi]", "n_"], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"b", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    RowBox[{
     SubscriptBox["\[Phi]", "n"], "[", 
     RowBox[{"x", "/", 
      RowBox[{"b", "[", "t", "]"}]}], "]"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"I", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "^", "2"}], "*", 
          FractionBox[
           RowBox[{
            RowBox[{"b", "'"}], "[", "t", "]"}], 
           RowBox[{"2", "*", 
            RowBox[{"b", "[", "t", "]"}]}]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", 
            FractionBox["1", "2"]}], ")"}], 
          RowBox[{"\[Tau]", "[", "t", "]"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "\[GreaterEqual]", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Psi]", "F"], "[", 
    RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "0"], "[", 
        RowBox[{"x", ",", "t"}], "]"}], 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "1"], "[", 
        RowBox[{"y", ",", "t"}], "]"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "0"], "[", 
        RowBox[{"y", ",", "t"}], "]"}], 
       RowBox[{
        SubscriptBox["\[CapitalPhi]", "1"], "[", 
        RowBox[{"x", ",", "t"}], "]"}]}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "F"], "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[Psi]", "F"], "[", 
       RowBox[{"x", ",", 
        SubscriptBox["x", "2"], ",", "0"}], "]"}], "*", 
      RowBox[{
       SubscriptBox["\[Psi]", "F"], "[", 
       RowBox[{"y", ",", 
        SubscriptBox["x", "2"], ",", "0"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["x", "2"], ",", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Psi]", "A"], "[", 
    RowBox[{"x_", ",", "y_", ",", "t_", ",", "\[Kappa]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{"I", "*", "\[Pi]", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Kappa]"}], ")"}], 
       RowBox[{"HeavisideTheta", "[", 
        RowBox[{"y", "-", "x"}], "]"}]}], ")"}]}], 
    RowBox[{
     SubscriptBox["\[Psi]", "F"], "[", 
     RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "\[Alpha]"], "[", 
    RowBox[{"x_", ",", "y_", ",", "\[Kappa]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Rho]", "F"], "[", 
     RowBox[{"x", ",", "y"}], "]"}], "-", 
    RowBox[{
     RowBox[{"Sign", "[", 
      RowBox[{"y", "-", "x"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sign", "[", 
            RowBox[{"y", "-", "x"}], "]"}]}], "*", "I", "*", "\[Pi]", "*", 
          "\[Kappa]"}], ")"}]}], "+", "1"}], ")"}], "*", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["\[Psi]", "F"], "[", 
         RowBox[{"x", ",", 
          SubscriptBox["x", "2"], ",", "0"}], "]"}], "*", 
        RowBox[{
         SubscriptBox["\[Psi]", "F"], "[", 
         RowBox[{"y", ",", 
          SubscriptBox["x", "2"], ",", "0"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["x", "2"], ",", "x", ",", " ", "y"}], "}"}]}], 
      "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[Rho]", "A"], "[", 
    RowBox[{"x_", ",", "y_", ",", "t_", ",", "\[Kappa]_"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"b", "[", "t", "]"}]], "*", 
    RowBox[{
     SubscriptBox["\[Rho]", "\[Alpha]"], "[", 
     RowBox[{
      FractionBox["x", 
       RowBox[{"b", "[", "t", "]"}]], ",", 
      FractionBox["y", 
       RowBox[{"b", "[", "t", "]"}]], ",", "\[Kappa]"}], "]"}], "*", 
    RowBox[{"E", "^", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"I", "*", 
         RowBox[{
          RowBox[{"b", "'"}], "[", "t", "]"}]}], 
        RowBox[{"2", 
         RowBox[{"b", "[", "t", "]"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"y", "^", "2"}], "-", 
         RowBox[{"x", "^", "2"}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["n", "A"], "[", 
    RowBox[{"p_", ",", "t_", ",", "\[Kappa]_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["2", 
     RowBox[{"2", "\[Pi]"}]], 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"E", "^", 
        RowBox[{"(", 
         RowBox[{"I", "*", "p", "*", 
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["\[Rho]", "A"], "[", 
        RowBox[{"x", ",", "y", ",", "t", ",", "\[Kappa]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", " ", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<LocalAdaptive\>\"", ",", " ", 
         RowBox[{"Method", "\[Rule]", "\"\<CartesianRule\>\""}]}], "}"}]}], 
      ",", " ", 
      RowBox[{"AccuracyGoal", "\[Rule]", "5"}], ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "5"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7380612778841333`*^9, 3.738061377229025*^9}, 
   3.7380621547132654`*^9, {3.738064151710709*^9, 3.738064234556838*^9}, {
   3.7380644248571634`*^9, 3.7380645388702564`*^9}, 3.738064593280442*^9, {
   3.7380646247808237`*^9, 3.7380647770313063`*^9}, {3.738064872312791*^9, 
   3.738064874255172*^9}, {3.7380654555436134`*^9, 3.7380655493897066`*^9}, {
   3.73806572157766*^9, 3.7380657250838523`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"472077fc-4243-4e47-93f9-3eb27e19649b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["n", "A"], "[", 
  RowBox[{"0", ",", "2", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.738065363758665*^9, 3.738065372989888*^9}, {
  3.7380657759330115`*^9, 3.7380657760030613`*^9}, {3.7380662971178756`*^9, 
  3.738066366158754*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"6c1ba083-7853-4503-907c-03dedc4e9e46"],

Cell[BoxData[
 RowBox[{"0.5641895212686454`", "\[VeryThinSpace]", "+", 
  RowBox[{"1.74454758789012`*^-17", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.73806537746305*^9, 3.7380655588024006`*^9, 3.7380657409271007`*^9, 
   3.738065838079075*^9, {3.7380663117209406`*^9, 3.738066376603532*^9}},
 CellLabel->
  "Out[248]=",ExpressionUUID->"05313884-d937-4560-986c-7d3da5e3d613"]
}, Open  ]]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7641, 235, 300, "Input",ExpressionUUID->"472077fc-4243-4e47-93f9-3eb27e19649b"],
Cell[CellGroupData[{
Cell[8224, 259, 362, 8, 28, "Input",ExpressionUUID->"6c1ba083-7853-4503-907c-03dedc4e9e46"],
Cell[8589, 269, 393, 7, 32, "Output",ExpressionUUID->"05313884-d937-4560-986c-7d3da5e3d613"]
}, Open  ]]
}
]
*)

